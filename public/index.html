<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Globalna Evropska Banka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .animate-pulse-slow {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #facc15 0%, #fde047 50%, #22c55e 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="font-sans">
    <div id="app" class="min-h-screen">
        <!-- Loading screen -->
        <div id="loading" class="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
            <div class="text-center text-white">
                <div class="animate-spin w-16 h-16 border-4 border-white border-t-transparent rounded-full mx-auto mb-4"></div>
                <h2 class="text-2xl font-bold">Nalaganje...</h2>
                <p>Globalna Evropska Banka</p>
            </div>
        </div>
    </div>

    <script>
        // Configuration API
        const API_URL = window.location.origin + '/api';
        let currentUser = null;
        let authToken = localStorage.getItem('authToken');

        // √âtat de l'application
        let appState = {
            currentScreen: 'home',
            currentImageIndex: 0,
            isLoggedIn: false,
            isAdmin: false,
            userAccount: null,
            pendingAccounts: []
        };
         // Langue simple
let currentLang = 'sl';

function setLanguage(lang) {
    currentLang = lang;
    showScreen('home');
}

function getText(slovenian, croatian) {
    return currentLang === 'hr' ? croatian : slovenian;
}

function getScrollingText() {
    const croatianTexts = [
        'Banka koja revolucionira digitalne bankovne usluge',
        '100 % digitalna, 100 % sigurna banka', 
        'Va≈°a buduƒánost bankarstva je ovdje',
        'Inovativna rje≈°enja za moderne korisnike'
    ];
    
    return currentLang === 'hr' ? 
        croatianTexts[appState.currentImageIndex] : 
        scrollingTexts[appState.currentImageIndex];
}
        // Nouvelle fonction pour les autres pages
function getPageText(key) {
    const translations = {
        // Page de connexion
        loginTitle: { sl: 'Prijava', hr: 'Prijava' },
        username: { sl: 'ID/Potni list', hr: 'ID/Putovnica' },
        password: { sl: 'Geslo', hr: 'Lozinka' },
        loginButton: { sl: 'Prijavite se', hr: 'Prijavite se' },
        back: { sl: 'Nazaj', hr: 'Natrag' },
        
        // Page d'inscription
        registerTitle: { sl: 'Registracija', hr: 'Registracija' },
        firstName: { sl: 'Ime', hr: 'Ime' },
        lastName: { sl: 'Priimek', hr: 'Prezime' },
         gender: { sl: 'Spol', hr: 'Spol' },
        male: { sl: 'Mo≈°ki', hr: 'Mu≈°ki' },
        female: { sl: '≈Ωenska', hr: '≈Ωenski' },
        birthDate: { sl: 'Datum rojstva', hr: 'Datum roƒëenja' },
        idNumber: { sl: '≈†tevilka osebne izkaznice ali potnega lista', hr: 'Broj osobne iskaznice ili putovnice' },
        country: { sl: 'Dr≈æava', hr: 'Zemlja' },
        city: { sl: 'Mesto', hr: 'Grad' },
        address: { sl: 'Naslov', hr: 'Adresa' },
        phone: { sl: 'Telefonska ≈°tevilka', hr: 'Telefonski broj' },
        confirmPassword: { sl: 'Potrdite geslo', hr: 'Potvrdite lozinku' },
        uploadDoc: { sl: 'Prilo≈æite osebno izkaznico ali potni list', hr: 'Prilo≈æite osobnu iskaznicu ili putovnicu' },
        validate: { sl: 'VALIDIRAJ', hr: 'POTVRDI' },
        selectFile: { sl: 'Izberite datoteko...', hr: 'Odaberite datoteku...' },
        // Page de contact
        contactTitle: { sl: 'Kontaktirajte nas', hr: 'Kontaktirajte nas' }
    };
    
    return translations[key] ? translations[key][currentLang] : key;
}
        // Donn√©es statiques
        const scrollingTexts = [
            "Banka, ki revolucionira digitalne banƒçne storitve",
            "100 % digitalna, 100 % varna banka",
            "Va≈°a prihodnost banƒçni≈°tva je tukaj",
            "Inovativne re≈°itve za moderne uporabnike"
        ];

        const bankImages = [
            {
                icon: "üì±",
                title: "Mobilno banƒçni≈°tvo",
                desc: "Dostop do vseh storitev"
            },
            {
                icon: "üí∂",
                title: "Transferji",
                desc: "Hitri in varni prenosi"
            },
            {
                icon: "üí≥",
                title: "Plaƒçilne kartice",
                desc: "Brezstiƒçne plaƒçila"
            },
            {
                icon: "üè¶",
                title: "Varne storitve",
                desc: "Za≈°ƒçita va≈°ega denarja"
            }
        ];

        // Fonctions utilitaires
        function showScreen(screenName) {
            appState.currentScreen = screenName;
            renderCurrentScreen();
        }

        function showMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.className = `fixed top-4 right-4 p-4 rounded-lg z-50 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            } text-white`;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                document.body.removeChild(messageDiv);
            }, 3000);
        }

        // API Calls
        async function apiCall(endpoint, method = 'GET', data = null) {
            try {
                const config = {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };

                if (authToken) {
                    config.headers['Authorization'] = `Bearer ${authToken}`;
                }

                if (data) {
                    config.body = JSON.stringify(data);
                }

                const response = await fetch(`${API_URL}${endpoint}`, config);
                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.message || 'Napaka pri komunikaciji s stre≈ænikom');
                }

                return result;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        // Authentication
        async function login(username, password) {
            try {
                const result = await apiCall('/login', 'POST', { username, password });
                
                if (result.success) {
                    authToken = result.token;
                    localStorage.setItem('authToken', authToken);
                    currentUser = result.user;
                    appState.isLoggedIn = true;
                    appState.isAdmin = result.user.isAdmin;
                    
                    if (result.user.isAdmin) {
                        showScreen('admin');
                        loadAdminData();
                    } else {
                        appState.userAccount = result.user;
                        showScreen('dashboard');
                    }
                    
                    showMessage('Prijava uspe≈°na!', 'success');
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function register(formData) {
            try {
                const result = await apiCall('/register', 'POST', formData);
                
                if (result.success) {
                    showMessage(result.message, 'success');
                    showScreen('waiting');
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function logout() {
            localStorage.removeItem('authToken');
            authToken = null;
            currentUser = null;
            appState.isLoggedIn = false;
            appState.isAdmin = false;
            appState.userAccount = null;
            showScreen('home');
        }

        // Admin functions
        async function loadAdminData() {
            try {
                const result = await apiCall('/admin/users');
                if (result.success) {
                    appState.pendingAccounts = result.users;
                    renderCurrentScreen();
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function approveUser(userId) {
            try {
                const result = await apiCall(`/admin/approve-user/${userId}`, 'POST');
                if (result.success) {
                    showMessage('Uporabnik odobren!', 'success');
                    loadAdminData();
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function blockUser(userId) {
            try {
                const result = await apiCall(`/admin/block-user/${userId}`, 'POST');
                if (result.success) {
                    showMessage('Uporabnik blokiran!', 'success');
                    loadAdminData();
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function unblockUser(userId) {
            try {
                const result = await apiCall(`/admin/unblock-user/${userId}`, 'POST');
                if (result.success) {
                    showMessage('Uporabnik odblokiran!', 'success');
                    loadAdminData();
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function updateBalance(userId, balance) {
            try {
                const result = await apiCall(`/admin/update-balance/${userId}`, 'POST', { balance });
                if (result.success) {
                    showMessage('Stanje posodobljeno!', 'success');
                    loadAdminData();
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function updateAccountNumber(userId, accountNumber) {
            try {
                const result = await apiCall(`/admin/update-account/${userId}`, 'POST', { accountNumber });
                if (result.success) {
                    showMessage('≈†tevilka raƒçuna posodobljena!', 'success');
                    loadAdminData();
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        async function sendContact(formData) {
            try {
                const result = await apiCall('/contact', 'POST', formData);
                if (result.success) {
                    showMessage('Sporoƒçilo uspe≈°no poslano!', 'success');
                }
            } catch (error) {
                showMessage(error.message, 'error');
            }
        }

        // Screen rendering functions
        function renderHomeScreen() {
            return `
                <div class="min-h-screen gradient-bg relative">
    <div class="container mx-auto p-4">
                        <!-- Logo et nom de la banque -->
                        <div class="text-center mb-6 pt-8">
                            <div class="flex items-center justify-center gap-3 mb-4">
                                <div class="w-12 h-12 flex items-center justify-center">
                                    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12">
                                        <defs>
                                            <radialGradient id="blueGradient" cx="0.3" cy="0.3" r="0.8">
                                                <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
                                                <stop offset="100%" style="stop-color:#1E3A8A;stop-opacity:1" />
                                            </radialGradient>
                                        </defs>
                                        <circle cx="100" cy="100" r="85" fill="url(#blueGradient)"/>
                                        <g stroke="rgba(255,255,255,0.2)" stroke-width="1" fill="none">
                                            <ellipse cx="100" cy="100" rx="25" ry="85"/>
                                            <ellipse cx="100" cy="100" rx="50" ry="85"/>
                                            <ellipse cx="100" cy="100" rx="70" ry="85"/>
                                            <line x1="15" y1="100" x2="185" y2="100"/>
                                            <ellipse cx="100" cy="100" rx="85" ry="25"/>
                                            <ellipse cx="100" cy="100" rx="85" ry="50"/>
                                        </g>
                                        <text x="100" y="115" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">GEB</text>
                                    </svg>
                                </div>
                                <!-- S√©lecteur de langue en haut √† droite -->
<div class="absolute top-4 right-4 flex gap-2">
    <button onclick="setLanguage('sl')" class="w-8 h-8 rounded-full text-xl hover:scale-110 transition-transform">
        üá∏üáÆ
    </button>
    <button onclick="setLanguage('hr')" class="w-8 h-8 rounded-full text-xl hover:scale-110 transition-transform">
        üá≠üá∑
    </button>
</div>

<h1 class="text-2xl font-bold text-red-600">${getText('GLOBALNA EVROPSKA BANKA', 'GLOBALNA EUROPSKA BANKA')}</h1>
                            </div>
                            
                            <!-- Texte d√©filant anim√© -->
                            <div class="bg-white/20 rounded-lg p-3 mb-6">
                                <div class="overflow-hidden">
                                    <div class="animate-pulse-slow">
                                       <p class="text-blue-800 font-medium text-center" id="scrollingText">
    ${getScrollingText()}
</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Images d√©filantes -->
                        <div class="bg-white rounded-lg card-shadow p-6 mb-8" id="imageCarousel">
                            <div class="text-center mb-4">
                                <div class="text-6xl mb-4">${bankImages[appState.currentImageIndex].icon}</div>
                                <h3 class="text-xl font-bold text-gray-800 mt-2">
                                    ${bankImages[appState.currentImageIndex].title}
                                </h3>
                                <p class="text-gray-600">
                                    ${bankImages[appState.currentImageIndex].desc}
                                </p>
                            </div>
                            
                            <!-- Indicateurs -->
                            <div class="flex justify-center gap-2">
                                ${bankImages.map((_, index) => `
                                    <div class="w-2 h-2 rounded-full ${
                                        index === appState.currentImageIndex ? 'bg-blue-600' : 'bg-gray-300'
                                    }"></div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Boutons d'action -->
                        <div class="space-y-4">
                            <button 
    onclick="showScreen('login')"
    class="w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg card-shadow hover:bg-blue-700 transition-colors"
>
    ${getText('PRIJAVA', 'PRIJAVA')}
</button>

<button 
    onclick="showScreen('register')"
    class="w-full bg-green-600 text-white py-4 rounded-lg font-bold text-lg card-shadow hover:bg-green-700 transition-colors"
>
    ${getText('REGISTRACIJA', 'REGISTRACIJA')}
</button>

<button 
    onclick="showScreen('contact')"
    class="w-full bg-red-600 text-white py-3 rounded-lg font-medium card-shadow hover:bg-red-700 transition-colors"
>
    ${getText('KONTAKTIRAJTE NAS', 'KONTAKTIRAJTE NAS')}
</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderLoginScreen() {
            const [username, setUsername] = ['', ''];
            const [password, setPassword] = ['', ''];

            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-400 to-blue-600 p-4">
                    <div class="container mx-auto max-w-md">
                        <div class="bg-white rounded-lg card-shadow p-6 mt-20">
                            <button 
                                onclick="showScreen('home')"
                                class="flex items-center text-blue-600 mb-6 hover:text-blue-800"
                            >
                               ‚Üê ${getPageText('back')}
                            </button>
                            
                            <h2 class="text-2xl font-bold text-center mb-8 text-gray-800">${getPageText('loginTitle')}</h2>
                            
                            <form onsubmit="handleLogin(event)" class="space-y-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">${getPageText('username')}</label>
                                    <input 
                                        type="text"
                                        id="loginUsername"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                                        placeholder="${getPageText('username')}"
                                    />
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">${getPageText('password')}</label>
                                    <input 
                                        type="password"
                                        id="loginPassword"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"
                                        placeholder="Vnesite geslo"
                                    />
                                </div>
                                
                                <button 
                                    type="submit"
                                    class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition-colors"
                                >
                                    Prijavite se
                                </button>
                                
                                <p class="text-center text-gray-600">
                                    Nimate raƒçuna? 
                                    <span 
                                        onclick="showScreen('register')"
                                        class="text-blue-600 cursor-pointer ml-1 hover:underline"
                                    >
                                        Registrirajte se
                                    </span>
                                </p>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderRegisterScreen() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-green-400 to-green-600 p-4">
                    <div class="container mx-auto max-w-md">
                        <div class="bg-white rounded-lg card-shadow p-6 mt-10">
                            <button 
                                onclick="showScreen('home')"
                                class="flex items-center text-green-600 mb-6 hover:text-green-800"
                            >
                                ‚Üê Nazaj
                            </button>
                            
                            <h2 class="text-2xl font-bold text-center mb-8 text-gray-800">${getPageText('registerTitle')}</h2>
                            
                            <form onsubmit="handleRegister(event)" class="space-y-4 max-h-96 overflow-y-auto">
                                <div>
                                    <label class="block text-gray-700 mb-2">${getPageText('gender')}</label>
                                    <div class="flex gap-4">
                                        <label class="flex items-center">
    <input type="radio" name="civilite" value="Mo≈°ki" required class="mr-2"/>
    ${getPageText('male')}
</label>
<label class="flex items-center">
    <input type="radio" name="civilite" value="≈Ωenska" required class="mr-2"/>
    ${getPageText('female')}
</label>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                <label class="block text-gray-700 mb-2">${getPageText('firstName')}</label>
                                        <input 
                                            type="text"
                                            name="ime"
                                            required
                                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                            placeholder="Ime"
                                        />
                                    </div>
                                    <div>
                            <label class="block text-gray-700 mb-2">${getPageText('lastName')}</label>
                                        <input 
                                            type="text"
                                            name="priimek"
                                            required
                                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                            placeholder="Priimek"
                                        />
                                    </div>
                                </div>

                                <div>
                        <label class="block text-gray-700 mb-2">${getPageText('birthDate')}</label>
                                    <input 
                                        type="date"
                                        name="dateNaissance"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                    />
                                </div>

                                <div>
                        <label class="block text-gray-700 mb-2">${getPageText('idNumber')}</label>
                                    <input 
                                        type="text"
                                        name="numeroId"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        placeholder="≈†tevilka dokumenta"
                                    />
                                </div>

                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                <label class="block text-gray-700 mb-2">${getPageText('country')}</label>
                                        <select 
                                            name="pays"
                                            required
                                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        >
                                            <option value="Slovenija">Slovenija</option>
                                            <option value="Hrva≈°ka">Hrva≈°ka</option>
                                            <option value="Avstrija">Avstrija</option>
                                            <option value="Italija">Italija</option>
                                        </select>
                                    </div>
                                    <div>
                        <label class="block text-gray-700 mb-2">${getPageText('city')}</label>
                                        <input 
                                            type="text"
                                            name="ville"
                                            required
                                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                            placeholder="Mesto"
                                        />
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Naslov</label>
                                    <input 
                                        type="text"
                                        name="adresse"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        placeholder="Polni naslov"
                                    />
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Telefonska ≈°tevilka</label>
                                    <input 
                                        type="tel"
                                        name="telephone"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        placeholder="+386 XX XXX XXX"
                                    />
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">E-po≈°ta</label>
                                    <input 
                                        type="email"
                                        name="email"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        placeholder="ime@email.com"
                                    />
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Geslo</label>
                                    <input 
                                        type="password"
                                        name="motDePasse"
                                        required
                                        minlength="6"
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        placeholder="Ustvarite geslo (min. 6 znakov)"
                                    />
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Potrdite geslo</label>
                                    <input 
                                        type="password"
                                        name="confirmerMotDePasse"
                                        required
                                        minlength="6"
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600"
                                        placeholder="Ponovite geslo"
                                    />
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2">Prilo≈æite osebno izkaznico ali potni list</label>
                                    <div class="relative">
                                        <input 
                                            type="file"
                                            name="documentUpload"
                                            accept="image/*,.pdf"
                                            required
                                            id="fileInput"
                                            class="hidden"
                                            onchange="updateFileName(this)"
                                        />
                                        <label 
                                            for="fileInput"
                                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600 bg-white cursor-pointer flex items-center justify-between hover:bg-gray-50"
                                        >
                                            <span id="fileName" class="text-gray-500">Izberite datoteko...</span>
                                            <span class="text-gray-400">üìé</span>
                                        </label>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">Sprejemamo: JPG, PNG, PDF (maks. 5MB)</p>
                                </div>

                                <button 
                                    type="submit"
                                    class="w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 transition-colors"
                                >
                                    VALIDIRAJ
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDashboardScreen() {
            const user = appState.userAccount;
            return `
                <div class="min-h-screen bg-black text-white" style="background-color: #000000 !important;">
                    <!-- Account Info -->
                    <div class="p-6">
                        <!-- Ligne du bouton de d√©connexion -->
                        <div class="flex justify-end mb-4">
                            <button 
                                onclick="logout()" 
                                class="bg-red-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-700 transition-colors"
                            >
                                Odjava
                            </button>
                        </div>
                        
                        <!-- Ligne ≈†TEVILKA RAƒåUNA centr√©e -->
                        <div class="text-center mb-6">
                            <p class="text-gray-400 text-sm mb-2">≈†TEVILKA RAƒåUNA</p>
                            <h1 class="text-2xl font-bold mb-6">${user?.accountNumber || 'SI56 3300 0001 3772 148'}</h1>
                            
                            <div class="flex items-center justify-center gap-2 mb-4">
                                <p class="text-gray-400">Razpolo≈æljivo stanje</p>
                                <div class="w-4 h-4 border border-gray-400 rounded-full flex items-center justify-center">
                                    <span class="text-xs">i</span>
                                </div>
                            </div>
                            
                            <h2 class="text-4xl font-bold mb-8">${user?.balance || '0,00'} ‚Ç¨</h2>
                            <!-- Action Buttons -->
                            <div class="grid grid-cols-4 gap-4 mb-8">
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-pink-600 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-white text-2xl">üí∂</span>
                                    </div>
                                    <p class="text-xs">Narediti</p>
                                    <p class="text-xs">Transfer</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-pink-600 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-white text-2xl">üí∞</span>
                                    </div>
                                    <p class="text-xs">Zahteva za</p>
                                    <p class="text-xs">kredit</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-pink-600 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-white text-2xl">üí≥</span>
                                    </div>
                                    <p class="text-xs">Skleniti</p>
                                    <p class="text-xs">izdelke</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="w-16 h-16 border-2 border-white rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-white text-2xl">...</span>
                                    </div>
                                    <p class="text-xs">Veƒç mo≈ænosti</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Products Section -->
                    <div class="px-4 bg-black pb-8">
                        <h3 class="text-xl font-bold mb-4">Izdelki dneva v dan</h3>
                        <p class="text-gray-400 mb-4">Skupno stanje ${user?.balance || '0,00'} ‚Ç¨</p>
                        
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <!-- Current Account Card -->
                            <div class="bg-blue-400 rounded-lg p-4">
                                <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center mb-4">
                                    <span class="text-blue-600 text-2xl">üí≥</span>
                                </div>
                                <p class="text-xs text-blue-900">RAƒåUN ...${user?.accountNumber?.slice(-4) || '1442'} | Imetnik</p>
                                <h4 class="text-lg font-bold text-black mb-4">
                                    CTA<br/>
                                    TEKOƒåI...
                                </h4>
                                <p class="text-xs text-blue-900 mb-1">Razpolo≈æljivo stanje</p>
                                <p class="text-2xl font-bold text-black">${user?.balance || '0,00'} ‚Ç¨</p>
                            </div>
                            
                            <!-- Debit Card -->
                            <div class="bg-gray-300 rounded-lg p-4">
                                <div class="flex justify-between items-start mb-4">
                                    <div class="w-12 h-8 bg-black rounded flex items-center justify-center">
                                        <span class="text-white text-xs">üí≥</span>
                                    </div>
                                    <div class="w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center">
                                        <span class="text-black text-xs">!</span>
                                    </div>
                                </div>
                                <p class="text-xs text-gray-700">DEBETNA KARTICA ...570...</p>
                                <h4 class="text-lg font-bold text-black mb-4">
                                    OPEN DEBIT<br/>
                                    MASTERCARD
                                </h4>
                                <p class="text-xs text-gray-700 mb-1">Povezani raƒçun</p>
                                <p class="text-sm text-black">CTA KORR... ...${user?.accountNumber?.slice(-4) || '1442'}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAdminScreen() {
            return `
                <div class="min-h-screen bg-gray-100 p-4">
                    <div class="container mx-auto">
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold text-gray-800">Nadzorna plo≈°ƒça administratorja</h2>
                                <button 
                                    onclick="logout()"
                                    class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"
                                >
                                    Odjava
                                </button>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="w-full border-collapse border border-gray-300">
                                    <thead>
                                        <tr class="bg-gray-50">
                                            <th class="border border-gray-300 p-3 text-left">ID</th>
                                            <th class="border border-gray-300 p-3 text-left">Ime</th>
                                            <th class="border border-gray-300 p-3 text-left">Priimek</th>
                                            <th class="border border-gray-300 p-3 text-left">E-po≈°ta</th>
                                            <th class="border border-gray-300 p-3 text-left">Telefon</th>
                                            <th class="border border-gray-300 p-3 text-left">≈†tevilka raƒçuna</th>
                                            <th class="border border-gray-300 p-3 text-left">Stanje</th>
                                            <th class="border border-gray-300 p-3 text-left">Status</th>
                                            <th class="border border-gray-300 p-3 text-left">Dejanja</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${appState.pendingAccounts.map((account) => `
                                            <tr class="hover:bg-gray-50">
                                                <td class="border border-gray-300 p-3">${account.numeroId}</td>
                                                <td class="border border-gray-300 p-3">${account.ime}</td>
                                                <td class="border border-gray-300 p-3">${account.priimek}</td>
                                                <td class="border border-gray-300 p-3">${account.email}</td>
                                                <td class="border border-gray-300 p-3">${account.telephone}</td>
                                                <td class="border border-gray-300 p-3">
                                                    <div class="flex items-center gap-2">
                                                        <span>${account.accountNumber || 'Ni dodeljeno'}</span>
                                                        <button 
                                                            onclick="showAccountModal('${account._id}', '${account.accountNumber || ''}')"
                                                            class="text-blue-600 hover:text-blue-800 text-sm"
                                                        >
                                                            ‚úèÔ∏è
                                                        </button>
                                                    </div>
                                                </td>
                                                <td class="border border-gray-300 p-3">
                                                    <div class="flex items-center gap-2">
                                                        <span>${account.balance} ‚Ç¨</span>
                                                        <button 
                                                            onclick="showBalanceModal('${account._id}', '${account.balance}')"
                                                            class="text-blue-600 hover:text-blue-800 text-sm"
                                                        >
                                                            ‚úèÔ∏è
                                                        </button>
                                                    </div>
                                                </td>
                                                <td class="border border-gray-300 p-3">
                                                    <span class="px-2 py-1 rounded text-xs ${
                                                        account.status === 'pending' ? 'bg-yellow-200 text-yellow-800' :
                                                        account.status === 'approved' ? 'bg-green-200 text-green-800' :
                                                        'bg-red-200 text-red-800'
                                                    }">
                                                        ${account.status === 'pending' ? 'V teku' :
                                                         account.status === 'approved' ? 'Odobreno' : 'Blokirano'}
                                                    </span>
                                                </td>
                                                <td class="border border-gray-300 p-3">
                                                    <div class="flex gap-2">
                                                        ${account.status === 'pending' ? `
                                                            <button 
                                                                onclick="approveUser('${account._id}')"
                                                                class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"
                                                            >
                                                                Odobri
                                                            </button>
                                                            <button 
                                                                onclick="blockUser('${account._id}')"
                                                                class="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"
                                                            >
                                                                Blokiraj
                                                            </button>
                                                        ` : account.status === 'approved' ? `
                                                            <button 
                                                                onclick="blockUser('${account._id}')"
                                                                class="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"
                                                            >
                                                                Blokiraj
                                                            </button>
                                                        ` : account.status === 'blocked' ? `
                                                            <button 
                                                                onclick="unblockUser('${account._id}')"
                                                                class="bg-yellow-600 text-white px-3 py-1 rounded text-sm hover:bg-yellow-700"
                                                            >
                                                                Odblokiranje
                                                            </button>
                                                        ` : ''}
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                            
                            ${appState.pendingAccounts.length === 0 ? `
                                <div class="text-center py-8 text-gray-500">
                                    Ni raƒçunov za obdelavo
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <!-- Modal pour modifier le solde -->
                    <div id="balanceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                        <div class="bg-white p-6 rounded-lg max-w-md w-full mx-4">
                            <h3 class="text-lg font-bold mb-4">Posodobi stanje</h3>
                            <input 
                                type="text" 
                                id="newBalanceInput" 
                                placeholder="0,00"
                                class="w-full p-3 border rounded-lg mb-4"
                            />
                            <div class="flex gap-2">
                                <button 
                                    onclick="saveBalance()"
                                    class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
                                >
                                    Shrani
                                </button>
                                <button 
                                    onclick="closeBalanceModal()"
                                    class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"
                                >
                                    Prekliƒçi
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Modal pour modifier le num√©ro de compte -->
                    <div id="accountModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                        <div class="bg-white p-6 rounded-lg max-w-md w-full mx-4">
                            <h3 class="text-lg font-bold mb-4">Posodobi ≈°tevilko raƒçuna</h3>
                            <input 
                                type="text" 
                                id="newAccountInput" 
                                placeholder="SI56 3300 0001 3772 1234"
                                class="w-full p-3 border rounded-lg mb-4"
                            />
                            <div class="flex gap-2">
                                <button 
                                    onclick="saveAccount()"
                                    class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
                                >
                                    Shrani
                                </button>
                                <button 
                                    onclick="closeAccountModal()"
                                    class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"
                                >
                                    Prekliƒçi
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderWaitingScreen() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-blue-400 to-purple-600 flex items-center justify-center p-4">
                    <div class="bg-white rounded-lg card-shadow p-8 text-center max-w-md">
                        <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-white text-3xl">üè¶</span>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Hvala za registracijo!</h2>
                        <p class="text-gray-600 mb-6">
                            Va≈° banƒçni raƒçun je v postopku odpiranja. Prosimo, poƒçakajte.
                        </p>
                        <div class="animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-6"></div>
                        <button 
                            onclick="showScreen('home')"
                            class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"
                        >
                            Nazaj na zaƒçetek
                        </button>
                    </div>
                </div>
            `;
        }

        function renderContactScreen() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-red-400 to-red-600 p-4">
                    <div class="container mx-auto max-w-md">
                        <div class="bg-white rounded-lg card-shadow p-6 mt-20">
                            <button 
                                onclick="showScreen('home')"
                                class="flex items-center text-red-600 mb-6 hover:text-red-800"
                            >
                                ‚Üê ${getPageText('back')}
                            </button>
                            
                            <h2 class="text-2xl font-bold text-center mb-8 text-gray-800">Kontaktirajte nas</h2>
                            
                            <form onsubmit="handleContact(event)" class="space-y-4">
                                <div>
                                    <label class="block text-gray-700 mb-2">Ime</label>
                                    <input 
                                        type="text"
                                        name="ime"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"
                                        placeholder="Va≈°e ime"
                                    />
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">E-po≈°ta</label>
                                    <input 
                                        type="email"
                                        name="email"
                                        required
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"
                                        placeholder="ime@email.com"
                                    />
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">Sporoƒçilo</label>
                                    <textarea 
                                        name="sporocilo"
                                        required
                                        rows="4"
                                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"
                                        placeholder="Napi≈°ite va≈°e sporoƒçilo..."
                                    ></textarea>
                                </div>
                                
                                <button 
                                    type="submit"
                                    class="w-full bg-red-600 text-white py-3 rounded-lg font-bold hover:bg-red-700 transition-colors"
                                >
                                    üìß Po≈°ljite sporoƒçilo
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        }

        // Event handlers
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            login(username, password);
        }

        function handleRegister(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            
            if (data.motDePasse !== data.confirmerMotDePasse) {
                showMessage('Gesli se ne ujemata', 'error');
                return;
            }
            
            register(data);
        }

        function handleContact(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            sendContact(data);
            event.target.reset();
        }

        // Admin modal functions
        let currentEditingUserId = null;
        let currentEditingAccountId = null;

        function showBalanceModal(userId, currentBalance) {
            currentEditingUserId = userId;
            document.getElementById('newBalanceInput').value = currentBalance.replace(' ‚Ç¨', '');
            document.getElementById('balanceModal').classList.remove('hidden');
        }

        function closeBalanceModal() {
            document.getElementById('balanceModal').classList.add('hidden');
            currentEditingUserId = null;
        }

        function saveBalance() {
            const newBalance = document.getElementById('newBalanceInput').value;
            if (currentEditingUserId && newBalance) {
                updateBalance(currentEditingUserId, newBalance);
                closeBalanceModal();
            }
        }

        function showAccountModal(userId, currentAccount) {
            currentEditingAccountId = userId;
            document.getElementById('newAccountInput').value = currentAccount;
            document.getElementById('accountModal').classList.remove('hidden');
        }

        function closeAccountModal() {
            document.getElementById('accountModal').classList.add('hidden');
            currentEditingAccountId = null;
        }

        function saveAccount() {
            const newAccount = document.getElementById('newAccountInput').value;
            if (currentEditingAccountId && newAccount) {
                updateAccountNumber(currentEditingAccountId, newAccount);
                closeAccountModal();
            }
        }

        // Fonction pour mettre √† jour le nom du fichier
        function updateFileName(input) {
            const fileName = document.getElementById('fileName');
            if (input.files && input.files[0]) {
                fileName.textContent = input.files[0].name;
                fileName.classList.remove('text-gray-500');
                fileName.classList.add('text-gray-800');
            } else {
                fileName.textContent = 'Izberite datoteko...';
                fileName.classList.remove('text-gray-800');
                fileName.classList.add('text-gray-500');
            }
        }

        // Main render function
        function renderCurrentScreen() {
            const app = document.getElementById('app');
            
            switch (appState.currentScreen) {
                case 'home':
                    app.innerHTML = renderHomeScreen();
                    break;
                case 'login':
                    app.innerHTML = renderLoginScreen();
                    break;
                case 'register':
                    app.innerHTML = renderRegisterScreen();
                    break;
                case 'dashboard':
                    app.innerHTML = renderDashboardScreen();
                    break;
                case 'admin':
                    app.innerHTML = renderAdminScreen();
                    break;
                case 'waiting':
                    app.innerHTML = renderWaitingScreen();
                    break;
                case 'contact':
                    app.innerHTML = renderContactScreen();
                    break;
                default:
                    app.innerHTML = renderHomeScreen();
            }
        }

        // Auto login check
        async function checkAutoLogin() {
            if (authToken) {
                try {
                    const result = await apiCall('/user/profile');
                    if (result.success) {
                        currentUser = result.user;
                        appState.isLoggedIn = true;
                        appState.isAdmin = result.user.isAdmin;
                        
                        if (result.user.isAdmin) {
                            showScreen('admin');
                            loadAdminData();
                        } else {
                            appState.userAccount = result.user;
                            showScreen('dashboard');
                        }
                        return;
                    }
                } catch (error) {
                    console.log('Auto login failed');
                    localStorage.removeItem('authToken');
                    authToken = null;
                }
            }
            showScreen('home');
        }

        // Initialize app
        function initApp() {
            // Image carousel
            setInterval(() => {
                appState.currentImageIndex = (appState.currentImageIndex + 1) % bankImages.length;
                if (appState.currentScreen === 'home') {
                    const scrollingText = document.getElementById('scrollingText');
                    const imageCarousel = document.getElementById('imageCarousel');
                    if (scrollingText) {
                        scrollingText.textContent = scrollingTexts[appState.currentImageIndex];
                    }
                    if (imageCarousel) {
                        renderCurrentScreen();
                    }
                }
            }, 3000);

            // Check auto login
            checkAutoLogin();
        }

        // Start app when page loads
        window.addEventListener('load', () => {
            document.getElementById('loading').style.display = 'none';
            initApp();
        });
    </script>
</body>
</html>
